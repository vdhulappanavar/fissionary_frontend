<!DOCTYPE html>
<html>
  <head>
  
    <script src="http://code.jquery.com/jquery-1.4.2.min.js"></script>
	<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
    <script>
       /* jQuery(window).ready(function(){
          jQuery("#findLocationBtn").click(initiate_geolocation);
        });
        
        function initiate_geolocation() {
            navigator.geolocation.getCurrentPosition(handle_geolocation_query,handle_errors);
        }
        function handle_errors(error)
        {
            switch(error.code)
            {
                case error.PERMISSION_DENIED: alert("user did not share geolocation data");
                break;
                case error.POSITION_UNAVAILABLE: alert("could not detect current position");
                break;
                case error.TIMEOUT: alert("retrieving position timed out");
                break;
                default: alert("unknown error");
                break;
            }
        }*/
        function handle_geolocation_query()
        {
			console.log("inside handle_geolocation_query");
            /*var google_tile = "http://maps.google.com/maps/api/staticmap?sensor=false&center=" + position.coords.latitude + "," +
                            position.coords.longitude + "&zoom=14&size=300x400&markers=color:blue|label:U|" +
                            position.coords.latitude + ',' + position.coords.longitude;*/
			//var address = "Bangalore";
			//var address = 'Kolkata';
			var address = 'wonderla amusement park';
			var lat =0;
			var lng = 0;
            geocoder = new google.maps.Geocoder();
            geocoder.geocode({
            'address': address
            }, function(results, status) {      
                //var lat=document.getElementById("lat").innerHTML=results[0].geometry.location.lat();    
                //var lng=document.getElementById("lng").innerHTML=results[0].geometry.location.lng(); 

				lat = results[0].geometry.location.lat();
				lng = results[0].geometry.location.lng();
				console.log("inside function " + lat + "::"+lng);
				var google_tile = "http://maps.google.com/maps/api/staticmap?sensor=false&center=" + lat + "," +
                            lng + "&zoom=17&size=300x400";
            var canvas = document.getElementById("myCanvas");
            var context = canvas.getContext("2d");   
             imageObj = new Image();
            imageObj.src = google_tile;
			imageObj.onload = function(){
              context.drawImage(imageObj, 0, 0);
			  foo();
            }
            });

			//var google_tile = "http://maps.googleapis.com/maps/api/staticmap?address="+address+"&sensor=false&zoom=14&size=100x100";
			//console.log("outside function " + lat + "::"+lng);
			
			
            
            
        }
		function foo()
		{
			var canvas = document.getElementById('myCanvas');
			var ctx = canvas.getContext('2d');
			//park view
			ctx.fillStyle = 'green';
			ctx.fillRect(130, 110, 20, 20);
			//axis bank 
			ctx.fillStyle = 'green';
			ctx.fillRect(150, 150, 20, 20);
			//pizza corner
			ctx.fillStyle = 'green';
			ctx.fillRect(100, 180, 20, 20);
			//toilet
			ctx.fillStyle = 'green';
			ctx.fillRect(50, 230, 20, 20);
			//court yard
			ctx.fillStyle = 'green';
			ctx.fillRect(140, 290, 20, 20);
			//XD max 
			ctx.fillStyle = 'green';
			ctx.fillRect(130, 340, 20, 20);
			//Roller coaster
			ctx.fillStyle = 'green';
			ctx.fillRect(160, 370, 20, 20);
			//equinox
			ctx.fillStyle = 'green';
			ctx.fillRect(210, 300, 20, 20);
			//maveric ride
			ctx.fillStyle = 'green';
			ctx.fillRect(190, 260, 20, 20);
			//dungeon ride
			ctx.fillStyle = 'green';
			ctx.fillRect(260, 130, 20, 20);
			//musical fountain 
			ctx.fillStyle = 'green';
			ctx.fillRect(210, 170, 20, 20);			
			
		}
		
		/*
			What meta data we need : Location name to extra the location from maps 
			and zoom number : this from config file 
			and lat long of each of the places an corresponding ids so that it could be mapped to table as well : this from json			
		*/
    </script>
  </head>
  <body onload ="handle_geolocation_query()">      
        <canvas id="myCanvas" width="300px" height="400px" style="border:1px solid grey;">
        </canvas>
		<button onclick="foo()">foo</button>
  </body>
</html>